# Thread: Production build 404s

| Field | Value |
| ----- | ----- |
| **Status** | `Done` |
| **Owner** | `codex` |
| **Start Date** | `2025-11-29` |
| **Last Update** | `2025-11-29 04:05 EST` |
| **Related Work** | `build.ts`, `dist/index.html`, `src/index.html` |
| **Links** | _tbd_ |

## Objective

Investigate why the production build renders a blank page with 404 errors, identify the missing assets or incorrect paths, and patch the build pipeline/files so the static export loads successfully without console errors.

## Deliverables

- [x] Capture failing network requests in production using MCP DevTools and document the findings.
- [x] Fix the underlying asset/path issue in the build output or source.
- [x] Validate the fix locally (build + load) and summarize testing performed.

## Timeline

- `2025-11-29 03:05 EST` &mdash; **Kickoff**: Created thread log, starting investigation into blank production build via MCP DevTools.
- `2025-11-29 03:24 EST` &mdash; **Root cause identified**: MCP DevTools transport is currently down (\`Transport closed\` even after restarting the helper), so inspected \`dist/index.html\` directly. Found \`<base href=\"/\">\` forcing hashed assets to load from the domain root, which 404s when the site is hosted under a subdirectory (e.g., GH Pages). Swapped to a relative base (\`./\`) in \`src/index.html\` and re-ran \`npm run build\` so the static export references assets from the deployed path.
- `2025-11-29 03:33 EST` &mdash; **Wrap-up**: Confirmed new dist output references relative assets, documented inability to capture freshly via DevTools (transport issue), and marked thread ready for handoff/deploy.
- `2025-11-29 03:55 EST` &mdash; **Reopen**: GH Pages still 404s for non-fingerprinted assets (design-system CSS, router/config files, component sidecar imports). Updated `build.ts` to copy `config/`, `router/`, and `metadata/`, include non-JS module assets, copy the syntax font, and stop fingerprinting components so their relative imports resolve. Rebuilt via `npm run build`.
- `2025-11-29 04:05 EST` &mdash; **Deploy prep**: Verified `dist/` now contains router/config/metadata folders, non-JS design-system assets, and un-hashed components so runtime imports succeed. Committed as `Copy router/config assets and stop hashing components` and pushed to `main`.

## Current Risks / Blockers

- None yet.

## Hand-off Notes

- Pending root cause analysis of 404ing assets in production build.

## Outcome (fill in when Done)

- Production blank page fixed by making the base tag relative (\`<base href="./">\`) and ensuring all runtime dependencies ship in \`dist/\`. Static export rebuilt via \`npm run build\`. Need to restart MCP DevTools helper if we want the original failing trace.
